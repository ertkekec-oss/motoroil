TAP version 13
# [Prisma] Initializing PrismaClientSingleton v2 (Robust Isolation)
# Subtest: Earnings Release Engine
    # Subtest: processes release correctly applying ledger entries
    not ok 1 - processes release correctly applying ledger entries
      ---
      duration_ms: 913.642
      type: 'test'
      location: 'C:\\Users\\ertke\\OneDrive\\Masaüstü\\periodya\\muhasebeapp\\motoroil\\tests\\earnings\\release.test.ts:2:3495'
      failureType: 'testCodeFailure'
      error: 'LedgerAccount not found for seller test-seller-co-da75e269-28c9-478c-bbaa-6e295aae18ca'
      code: 'ERR_TEST_FAILURE'
      stack: |-
        createReleaseLedgerEntries (C:\Users\ertke\OneDrive\Masaüstü\periodya\muhasebeapp\motoroil\src\services\finance\earnings\ledgerPosting.ts:50:15)
        async <anonymous> (C:\Users\ertke\OneDrive\Masaüstü\periodya\muhasebeapp\motoroil\src\services\finance\earnings\releaseSingle.ts:78:9)
        async Proxy._transactionWithCallback (C:\Users\ertke\OneDrive\Masaüstü\periodya\muhasebeapp\motoroil\node_modules\@prisma\client\runtime\library.js:130:8000)
        async releaseSingleEarning (C:\Users\ertke\OneDrive\Masaüstü\periodya\muhasebeapp\motoroil\src\services\finance\earnings\releaseSingle.ts:11:5)
        async TestContext.<anonymous> (C:\Users\ertke\OneDrive\Masaüstü\periodya\muhasebeapp\motoroil\tests\earnings\release.test.ts:109:9)
        async Test.run (node:internal/test_runner/test:1054:7)
        async Promise.all (index 0)
        async Suite.run (node:internal/test_runner/test:1442:7)
        async startSubtestAfterBootstrap (node:internal/test_runner/harness:296:3)
      ...
    # Subtest: rejects concurrent executions idempotently
    ok 2 - rejects concurrent executions idempotently
      ---
      duration_ms: 293.6036
      type: 'test'
      ...
    # Subtest: no-ops safely on subsequent calls for completed earnings
    not ok 3 - no-ops safely on subsequent calls for completed earnings
      ---
      duration_ms: 546.4385
      type: 'test'
      location: 'C:\\Users\\ertke\\OneDrive\\Masaüstü\\periodya\\muhasebeapp\\motoroil\\tests\\earnings\\release.test.ts:2:5633'
      failureType: 'testCodeFailure'
      error: 'LedgerAccount not found for seller test-seller-co-da75e269-28c9-478c-bbaa-6e295aae18ca'
      code: 'ERR_TEST_FAILURE'
      stack: |-
        createReleaseLedgerEntries (C:\Users\ertke\OneDrive\Masaüstü\periodya\muhasebeapp\motoroil\src\services\finance\earnings\ledgerPosting.ts:50:15)
        async <anonymous> (C:\Users\ertke\OneDrive\Masaüstü\periodya\muhasebeapp\motoroil\src\services\finance\earnings\releaseSingle.ts:78:9)
        async Proxy._transactionWithCallback (C:\Users\ertke\OneDrive\Masaüstü\periodya\muhasebeapp\motoroil\node_modules\@prisma\client\runtime\library.js:130:8000)
        async releaseSingleEarning (C:\Users\ertke\OneDrive\Masaüstü\periodya\muhasebeapp\motoroil\src\services\finance\earnings\releaseSingle.ts:11:5)
        async TestContext.<anonymous> (C:\Users\ertke\OneDrive\Masaüstü\periodya\muhasebeapp\motoroil\tests\earnings\release.test.ts:166:9)
        async Test.run (node:internal/test_runner/test:1054:7)
        async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
      ...
    1..3
not ok 1 - Earnings Release Engine
  ---
  duration_ms: 4866.8709
  type: 'suite'
  location: 'C:\\Users\\ertke\\OneDrive\\Masaüstü\\periodya\\muhasebeapp\\motoroil\\tests\\earnings\\release.test.ts:2:1205'
  failureType: 'subtestsFailed'
  error: '2 subtests failed'
  code: 'ERR_TEST_FAILURE'
  ...
1..1
# tests 3
# suites 1
# pass 1
# fail 2
# cancelled 0
# skipped 0
# todo 0
# duration_ms 6188.2813
