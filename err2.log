TAP version 13
# [Prisma] Initializing PrismaClientSingleton v2 (Robust Isolation)
# Subtest: Earnings Release Engine
    # Subtest: processes release correctly applying ledger entries
    not ok 1 - processes release correctly applying ledger entries
      ---
      duration_ms: 0
      type: 'test'
      location: 'C:\\Users\\ertke\\OneDrive\\Masaüstü\\periodya\\muhasebeapp\\motoroil\\tests\\earnings\\release.test.ts:2:3239'
      failureType: 'cancelledByParent'
      error: 'test did not finish before its parent and was cancelled'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: rejects concurrent executions idempotently
    not ok 2 - rejects concurrent executions idempotently
      ---
      duration_ms: 0
      type: 'test'
      location: 'C:\\Users\\ertke\\OneDrive\\Masaüstü\\periodya\\muhasebeapp\\motoroil\\tests\\earnings\\release.test.ts:2:4976'
      failureType: 'cancelledByParent'
      error: 'test did not finish before its parent and was cancelled'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: no-ops safely on subsequent calls for completed earnings
    not ok 3 - no-ops safely on subsequent calls for completed earnings
      ---
      duration_ms: 0
      type: 'test'
      location: 'C:\\Users\\ertke\\OneDrive\\Masaüstü\\periodya\\muhasebeapp\\motoroil\\tests\\earnings\\release.test.ts:2:5377'
      failureType: 'cancelledByParent'
      error: 'test did not finish before its parent and was cancelled'
      code: 'ERR_TEST_FAILURE'
      ...
    1..3
not ok 1 - Earnings Release Engine
  ---
  duration_ms: 1460.9319
  type: 'suite'
  location: 'C:\\Users\\ertke\\OneDrive\\Masaüstü\\periodya\\muhasebeapp\\motoroil\\tests\\earnings\\release.test.ts:2:1205'
  failureType: 'hookFailed'
  error: |-
    
    Invalid `prisma.company.create()` invocation in
    C:\Users\ertke\OneDrive\Masaüstü\periodya\muhasebeapp\motoroil\tests\earnings\release.test.ts:19:30
    
      16 before(async () => {
      17     // Minimal setup
      18     // Create platform tenant first (for the foreign key constraint)
    → 19     await prisma.company.create({
               data: {
                 id: "platform-tenant-for-testing",
                 name: "Platform Tenant",
                 type: "PLATFORM",
                 status: "ACTIVE",
                 vkn: "999999998",
                 taxOffice: "Test",
                 taxNumber: "999999997",
             +   tenant: {
             +     create: TenantCreateWithoutCompaniesInput | TenantUncheckedCreateWithoutCompaniesInput,
             +     connectOrCreate: TenantCreateOrConnectWithoutCompaniesInput,
             +     connect: TenantWhereUniqueInput
             +   }
               }
             })
    
    Argument `tenant` is missing.
  code: 'ERR_TEST_FAILURE'
  stack: |-
    wn (C:\Users\ertke\OneDrive\Masaüstü\periodya\muhasebeapp\motoroil\node_modules\@prisma\client\runtime\library.js:29:1363)
    $n.handleRequestError (C:\Users\ertke\OneDrive\Masaüstü\periodya\muhasebeapp\motoroil\node_modules\@prisma\client\runtime\library.js:121:6958)
    $n.handleAndLogRequestError (C:\Users\ertke\OneDrive\Masaüstü\periodya\muhasebeapp\motoroil\node_modules\@prisma\client\runtime\library.js:121:6623)
    $n.request (C:\Users\ertke\OneDrive\Masaüstü\periodya\muhasebeapp\motoroil\node_modules\@prisma\client\runtime\library.js:121:6307)
    async l (C:\Users\ertke\OneDrive\Masaüstü\periodya\muhasebeapp\motoroil\node_modules\@prisma\client\runtime\library.js:130:9633)
    async SuiteContext.<anonymous> (C:\Users\ertke\OneDrive\Masaüstü\periodya\muhasebeapp\motoroil\tests\earnings\release.test.ts:19:9)
    async TestHook.run (node:internal/test_runner/test:1054:7)
    async Suite.runHook (node:internal/test_runner/test:965:9)
    async Suite.run (node:internal/test_runner/test:1436:7)
    async startSubtestAfterBootstrap (node:internal/test_runner/harness:296:3)
  ...
1..1
# tests 3
# suites 1
# pass 0
# fail 0
# cancelled 3
# skipped 0
# todo 0
# duration_ms 2265.1662
